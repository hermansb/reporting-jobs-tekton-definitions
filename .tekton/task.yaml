apiVersion: tekton.dev/v1beta1
kind: Task
metadata:
  name: task-initiate-reporting-jobs
spec:
  workspaces:
    - name: pipeline-pvc
      mountPath: /pipeline-pvc
  params:
    - name: username
    - name: password
    - name: url
  steps:
    - name: initiate-reporting-jobs
      image: ibmcom/pipeline-base-image
      workingDir: /workspace
      env:
        - name: JOBS_USERNAME
          value: $(params.username)
        - name: JOBS_PASSWORD
          value: $(params.password)
        - name: url
          value: $(params.url)
      command: ["/bin/bash", "-c"]
      args:
        - |
          set -eo pipefail
          curl --request POST "$url" --header "Authorization: Basic $(echo -n "$JOBS_USERNAME:$JOBS_PASSWORD" | base64)"